# **Capítulo 18 – Wireless Infrastructure**

Este capítulo explica cómo se estructura una red Wi-Fi empresarial moderna, cómo se gestionan los puntos de acceso, cómo se controlan, cómo se autentican los usuarios y cómo se integran las WLAN con el tráfico cableado.  
Es un capítulo esencial para cualquier arquitectura Wireless LAN Controller (WLC) y Cisco Catalyst Wireless.

---

# **1. Arquitectura de red inalámbrica**

Wi-Fi empresarial se basa en tres elementos fundamentales:

1. **Access Points (APs)** – radios que transmiten/reciben RF.
    
2. **Wireless LAN Controller (WLC)** – administra APs, WLANs, seguridad y RF.
    
3. **Red cableada (switching/routing)** – transporte de CAPWAP, VLANs y tráfico de datos.
    

En la arquitectura moderna (Cisco 9800 Series), el WLC puede operar:

- **On-prem**,
    
- **En el cloud**,
    
- **Integrado en switches Catalyst**,
    
- **Virtualizado (vWLC, Catalyst 9800-CL).**
    

---

# **2. Tipos de APs en Cisco**

### **1. Autonomous AP (IOS AP)**

- Sin controlador.
    
- Configuración local en CLI o web.
    
- Ya casi obsoletos para Enterprise.
    

### **2. Lightweight AP (LWAP)**

- AP controlado por un WLC.
    
- Usa **CAPWAP** para conectarse al controlador.
    
- Gestión centralizada.
    

### **3. FlexConnect AP**

AP controlado por WLC pero con capacidad de operar parcialmente en forma local cuando pierde conexión:

- Autenticación local
    
- Switching local
    
- Ideal para oficinas remotas / sucursales.
    

---

# **3. Modos de operación de los APs**

Los AP Cisco no solo transmiten Wi-Fi; pueden operar en otros modos RF.

### **Local Mode**

Modo estándar.  
El AP:

- transmite Wi-Fi
    
- escanea canales adyacentes
    
- depende del WLC para switching
    

### **FlexConnect Mode**

Para sucursales.  
Ventajas:

- Sometimes-connected mode
    
- Switching local
    
- Autenticación local o centralizada
    

### **Monitor Mode**

- No transmite Wi-Fi
    
- Escanea canales
    
- Detección de interferencias
    
- WIDS/WIPS
    

### **Sniffer Mode**

Captura paquetes 802.11 y los envía a Wireshark o un sistema de análisis.

### **SE-Connect (Spectrum Expert)**

Para análisis de espectro (interferencias no-Wi-Fi).

### **Bridge/Mesh Mode**

- APs se conectan entre sí vía RF.
    
- Útil en outdoors o sitios sin cableado.
    

---

# **4. CAPWAP (Control And Provisioning of Wireless Access Points)**

Protocolo de control WLC ↔ AP.

### **Características**

- Encapsula el tráfico de gestión y datos.
    
- Usa DTLS para proteger la comunicación.
    
- Permite que los APs descarguen y actualicen imágenes.
    
- Estándar IETF (RFC 5415).
    

### **Puertos usados**

- **UDP 5246** – control
    
- **UDP 5247** – datos
    

### **Proceso de Join de APs**

1. Descubre el WLC (DHCP option 43, broadcast, DNS).
    
2. Se autentica.
    
3. Descarga firmware.
    
4. Carga configuración.
    
5. Comienza a transmitir.
    

---

# **5. WLANs, SSIDs y VLANs**

En redes Enterprise:

- Cada **WLAN (SSID)** se mapea a una **VLAN** cableada.
    
- Seguridad, QoS y políticas se aplican desde el WLC.
    

**Importante:**  
Más SSIDs → más overhead → menos eficiencia RF  
Recomendación empresarial: **≤ 4 SSIDs** por banda.

---

# **6. Centralized vs Distributed Architectures**

### **Centralized (Controlador en campus)**

- APs en modo **local**.
    
- Todo el tráfico pasa por el WLC (modo CAPWAP centralizado).
    
- Excelente para control total y seguridad.
    

### **Distributed (FlexConnect)**

- APs en sucursales.
    
- Switching local.
    
- El WLC solo controla autenticación y políticas.
    

---

# **7. Roaming Wi-Fi**

El roaming es el proceso de un cliente moviéndose de un AP a otro.

### **Roaming estándar**

- Basado en RSSI.
    
- Puede causar latencia o microcortes.
    

### **Roaming optimizado: 802.11k / 802.11r / 802.11v**

|Estándar|Función|
|---|---|
|**802.11k**|AP informa al cliente los mejores canales/APs vecinos.|
|**802.11r**|Fast Transition (FT); roaming rápido para voz/VoIP.|
|**802.11v**|Gestión de movilidad (BSS Transition Management).|

Wi-Fi empresarial usa estos tres para minimizar interrupciones.

---

# **8. Componentes clave de un WLC**

### **1. Management Interface**

Interfaz para administración del controlador.

### **2. AP-Manager Interface**

Donde los AP establecen CAPWAP (no siempre aparece en WLC modernos).

### **3. Dynamic Interfaces**

Mapean SSIDs a VLANs.

### **4. Virtual Interface**

Dirección IP virtual usada para autenticación, DHCP proxy y guest portals.

---

# **9. RRM (Radio Resource Management)**

El WLC ajusta automáticamente:

- Canales
    
- Potencia RF
    
- Band steering
    
- Load balancing
    

Componentes RRM:

- **DCA (Dynamic Channel Assignment)**
    
- **TPC (Transmit Power Control)**
    
- **Coverage Hole Detection**
    
- **Band Select**
    

Beneficio: optimiza el uso del espectro sin intervención humana.

---

# **10. Alta disponibilidad Wireless**

### **1. SSO (Stateful Switchover)**

Dos WLC actúan como un clúster HA.  
El failover es casi instantáneo.

### **2. N+1 Redundancy**

Varios WLC protegen sitios distribuidos.

### **3. AP Failover Priority**

Prioriza qué APs se conectan a qué WLC.

---

# **11. Seguridad en la infraestructura Wireless**

### **Autenticación**

- **WPA2-Enterprise (802.1X + RADIUS)**
    
- **WPA3-Enterprise**
    
- **FlexConnect Local Auth**
    

### **Guest Access**

- Captive Portal
    
- VLANs aisladas
    
- Firewalls o ACLs en el WLC
    

### **WIPS/WIDS**

- Detecta rogue APs
    
- Detecta spoofing o ataques RF
    
- Puede usar APs en modo monitor
    

---

# **12. QoS en wireless**

Wi-Fi usa **WMM (Wireless Multimedia)** para mapear prioridad:

|AC|Tráfico|
|---|---|
|**AC_VO**|Voz|
|**AC_VI**|Video|
|**AC_BE**|Best Effort|
|**AC_BK**|Background|

En el cableado, se usa DSCP → el WLC hace la traducción DSCP ↔ WMM.

---

# **13. Troubleshooting básico Wireless**

|Comando|Uso|
|---|---|
|`show ap summary`|Lista APs asociados|
|`show wlan summary`|Lista WLAN SSIDs|
|`show ap config general <ap>`|Configuración AP|
|`show wireless client summary`|Clientes conectados|
|`debug capwap events`|Mensajes de CAPWAP|
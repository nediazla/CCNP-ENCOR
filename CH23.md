# **Capítulo 23 – Fabric Technologies**

Una **fabric** es una arquitectura de red donde el tráfico de usuarios, segmentación, movilidad y políticas se manejan mediante **overlays automatizados**, en lugar de depender de VLANs tradicionales, STP o configuraciones manuales.

El fabric proporciona:

- **Movilidad de endpoints** sin reconfiguración
    
- **Segmentación escalable**
    
- **Redes virtuales (VRFs/VNIs) con control plane moderno**
    
- **Integración cableado + inalámbrico**
    
- **Automatización de políticas y rutas**
    

En Cisco Enterprise, esto se refleja en SD-Access, ACI, VXLAN/EVPN y otras soluciones basadas en **underlay IP + overlay encapsulado**.

---

# **1. Conceptos clave de un fabric**

Una fabric se basa en tres elementos estructurales:

## **1.1 Underlay**

La red física:

- Routing IP (generalmente OSPF o IS-IS)
    
- Direccionamiento punto a punto /31 o /30
    
- ECMP habilitado para múltiples rutas iguales
    
- Ninguna VLAN extendida
    
- Diseño **leaf-spine** o **core/distribution**
    

El underlay solo se encarga de **entrega IP básica**.

## **1.2 Overlay**

La red virtual construida sobre el underlay:

- Usualmente **VXLAN** para encapsulación
    
- Segmentación mediante **VNI** (24 bits → 16M redes virtuales)
    
- Edge nodes crean túneles hacia otros edge nodes
    

## **1.3 Control Plane**

Evita inundaciones (flooding) y broadcast innecesario.

Usa:

- **LISP (Locator/ID Separation Protocol)** en SD-Access
    
- **BGP EVPN** en Data Centers o campus avanzados
    

El control plane mantiene:

- Qué hosts existen
    
- Dónde están
    
- Qué SGT/VRF usan
    
- Qué VNI asignarles
    

---

# **2. VXLAN: el overlay dominante**

VXLAN (RFC 7348) es la tecnología principal en fabrics modernos.

### **Características clave**

- Encapsulación L2 sobre L3
    
- Puerto UDP 4789
    
- Usa **VNI** (VXLAN Network Identifier) en lugar de VLAN
    
- Permite movilidad de hosts sin cambiar topologías L2
    
- Soporta redes muy grandes
    

### **Estructura del paquete VXLAN**

`[Original Ethernet Frame] → VXLAN Header (VNI) → UDP Header (4789) → IP Header (Underlay) → MAC Header (Underlay)`

El tráfico se encapsula y viaja a través del underlay como un paquete IP normal.

---

# **3. EVPN (Ethernet VPN)**

EVPN es un **control-plane basado en BGP** para VXLAN.

Beneficios:

- Aprendizaje de MAC/IP sin flooding (control-plane learning)
    
- Movilidad de endpoints
    
- Soporte para Layer 2 + Layer 3
    
- Segmentación multi-tenant
    
- Mejor escalabilidad que L2 tradicional
    

Roles EVPN:

1. **Type-2 routes** → MAC/IP advertisement
    
2. **Type-3 routes** → IMET, multicast replication
    
3. **Type-5 routes** → L3 services (IP prefixes)
    

EVPN es el estándar moderno en Data Centers y campus avanzados.

---

# **4. SD-Access: Fabric Enterprise de Cisco**

El modelo SD-Access es la implementación Cisco para campus.

### **Componentes del Fabric**

- **Fabric Edge Node:** conecta usuarios
    
- **Fabric Border Node:** conecta fabric → red externa
    
- **Control-Plane Node:** base LISP, resuelve ubicaciones de hosts
    
- **Fabric WLC:** integra wireless al fabric
    
- **DNA Center:** controlador central
    

### **Protocolos**

- **VXLAN** → overlay
    
- **LISP** → control-plane
    
- **Cisco TrustSec (SGT)** → políticas y segmentación
    
- **IS-IS** → underlay típico
    

### **Beneficios**

- No STP
    
- Movilidad transparente (host tracking)
    
- Segmentación automática con SGT
    
- WLAN + LAN unificadas
    
- On-boarding seguro (802.1X + SGT)
    

---

# **5. Underlay Leaf-Spine Architecture**

Base recomendada para cualquier fabric moderno.

### **Leaf switches**

- Conectan a los clientes, servidores o APs
    
- No se conectan entre sí
    

### **Spine switches**

- Conectan únicamente a leaves
    
- Tráfico siempre pasa por un spine
    

### **Ventajas**

- Latencia predecible
    
- ECMP nativo
    
- Fácil escalabilidad horizontal
    
- El mejor modelo para VXLAN/EVPN
    

---

# **6. Encapsulación y segmentación**

Fabrics usan VNIs para separar tráfico:

- **L2 VNI:** transporta broadcast/multicast/ARP
    
- **L3 VNI:** transporta ruteo entre segmentos
    
- **SGTs (Security Group Tags)**: control basado en identidad (SD-Access)
    

### Equivalencia:

|Elemento tradicional|Fabric|
|---|---|
|VLAN|L2 VNI|
|VRF|L3 VNI|
|ACL por VLAN|Política por SGT|

Esto da segmentación “macro” y “micro”.

---

# **7. Control-plane learning vs Data-plane learning**

|Modelo tradicional|Fabric moderno|
|---|---|
|Flood and Learn|Controller-based learning|
|Dependencia ARP/MAC flooding|MAC/IP mapping centralizado|
|STP para loop-free|ECMP full mesh|
|Redes L2 inestables|L2 sobre L3 estable|

El cambio principal es **evitar flooding** y aprender ubicaciones mediante LISP/EVPN.

---

# **8. Integración Wireless en el Fabric**

En SD-Access:

- APs se convierten en parte del overlay
    
- El tráfico wireless se encapsula en VXLAN
    
- El WLC se integra como parte del Fabric Control Plane
    
- Los SGTs del cliente aplican directamente a usuarios inalámbricos
    

Diseño moderno = “Fabric-enabled Wireless”.

---

# **9. Servicios en un Fabric**

### **9.1 Onboarding**

- 802.1X
    
- MAC Authentication Bypass (MAB)
    
- SGT assignment
    
- Dynamic VLAN/VNI assignment
    

### **9.2 Routing en el Fabric**

- Los edge nodes manejan default gateways virtuales (Anycast Gateway)
    
- Clientes pueden moverse sin cambiar gateway local
    

### **9.3 Policy**

- TrustSec Security Group Tags
    
- Contract enforcement según SGT
    
- Integración con Cisco ISE
    

---

# **10. Fabric WAN: SD-WAN**

Aunque el capítulo se enfoca más en campus, es importante entender el paralelo:

### **SD-WAN fabric**

- Control-plane (vSmart)
    
- Data-plane (IPsec tunnels)
    
- Management-plane (vManage)
    

Comparte principios:

- Underlay ISP
    
- Overlay IPsec
    
- Control-plane seguro
    
- Routing basado en políticas
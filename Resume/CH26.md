# **Capítulo 26 – Network Device Access Control and Infrastructure Security**

El objetivo es proteger:

1. **El plano de administración (Management Plane)**
    
2. **El plano de control (Control Plane)**
    
3. **El plano de datos (Data Plane)**
    
4. **Los accesos administrativos (AAA, SSH, RBAC)**
    
5. **La infraestructura de red (routing, ARP, STP, servicios)**
    
6. **Las funciones de protección de switches (DHCP Snooping, DAI, IPSG)**
    

---

# **1. Protección del plano de administración (Management Plane Security)**

El plano de administración controla cómo se gestiona la red.

## **1.1 Deshabilitar servicios inseguros**

Servicios que deben desactivarse:

```
no ip http server
no ip bootp server
no ip source-route
no service tcp-small-servers
no service udp-small-servers
no ip domain-lookup
```

## **1.2 Uso obligatorio de SSH**

```
ip domain-name empresa.com
crypto key generate rsa modulus 2048
ip ssh version 2
line vty 0 4
 transport input ssh
 login local
```
## **1.3 AAA para administración**

```
aaa new-model
aaa authentication login default group tacacs+ local
aaa authorization exec default group tacacs+ local
aaa accounting commands 15 default start-stop group tacacs+
```

## **1.4 Role-Based Access Control (RBAC)**

Permite crear views:

```
parser view OPERATIONS
 secret cisco123
 commands exec include show
```

---

# **2. Protección del plano de control (Control Plane Security)**

El plano de control maneja _routing_, _protocolos_ y _tablas de control_.

Las amenazas incluyen:

- Ataques BGP/OSPF
    
- Flooding ICMP
    
- Paquetes mal formados
    
- CPU starvation
    

Las tecnologías clave son:

---

## **2.1 Control Plane Policing (CoPP)**

CoPP protege la CPU del router usando políticas MQC para limitar tráfico no deseado dirigido al plano de control.

Ejemplo:

```
class-map match-any MGMT-TRAFFIC
 match protocol ssh
 match protocol snmp

policy-map CONTROL-PLANE-POLICY
 class MGMT-TRAFFIC
  police 500000 conform-action transmit exceed-action drop
 class class-default
  drop

control-plane
 service-policy input CONTROL-PLANE-POLICY
```
---

## **2.2 Control Plane Protection (CPPr)**

Extiende CoPP y permite separar tráfico en:

- **Host Subinterface** (SSH, SNMP, Telnet)
    
- **Transit Subinterface**
    
- **CEF Exception Subinterface**
    

Permite granularidad más fina.

---

# **3. Protección del plano de datos (Data Plane Security)**

El plano de datos maneja el reenvío de tráfico. Aquí se aplican ACLs, QoS y funcionalidades de switch para evitar ataques L2.

---

# **4. Seguridad en switches Catalyst (Layer 2 Security)**

### **4.1 DHCP Snooping**

Protege contra servidores DHCP falsos.

```
ip dhcp snooping
ip dhcp snooping vlan 10
interface Gi0/1
 ip dhcp snooping trust
```

---

### **4.2 Dynamic ARP Inspection (DAI)**

Evita ARP spoofing usando la tabla de DHCP Snooping.

```
ip arp inspection vlan 10
interface Gi0/1
 ip arp inspection trust
```

---

### **4.3 IP Source Guard (IPSG)**

Evita spoofing IP+MAC.

```
interface Gi0/2
 ip verify source
interface Gi0/2
 ip verify source
```

---

### **4.4 Port Security**

Limita cuántas MAC se permiten en un puerto.

```
switchport mode access
switchport port-security
switchport port-security maximum 2
switchport port-security violation restrict
```

---

# **5. Protección de protocolos de enrutamiento (Routing Protocol Security)**

Protocols como OSPF, EIGRP y BGP deben autenticarse para evitar inyecciones de rutas.

### **5.1 OSPF Authentication**

```
ip ospf message-digest-key 1 md5 cisco 
area 0 authentication message-digest
```

### **5.2 EIGRP Authentication**

```
key chain EIGRP-KEYS
 key 1
  key-string cisco123
interface Gi0/0
 ip authentication mode eigrp 1 md5
 ip authentication key-chain eigrp 1 EIGRP-KEYS
```

### **5.3 BGP Authentication**

```
neighbor 192.0.2.1 password cisco123
```

---

# **6. Routing Infrastructure Protection**

### **6.1 Unicast Reverse Path Forwarding (uRPF)**

Previene spoofing IP.

```
ip verify unicast source reachable-via rx
```

### Modos:

- **strict** (más seguro)
    
- **loose** (más tolerante)
    

---

### **6.2 Bogon filtering / Prefix-lists**

Filtrar redes privadas o inválidas en borde:

```
ip prefix-list BOGONS deny 127.0.0.0/8 
ip prefix-list BOGONS deny 0.0.0.0/8
```

---

### **6.3 Control de ICMP Redirects / Proxy ARP**

```
no ip redirects 
no ip proxy-arp
```

---

# **7. Infraestructura segura con First Hop Security (FHS)**

Cisco FHS protege capa 2 en Access Layer.

Incluye:

- DHCP Snooping
    
- DAI
    
- IP Source Guard
    
- RA Guard (IPv6)
    
- ND Inspection
    
- IPv6 Snooping
    

### Ejemplo (IPv6 RA Guard)

```
interface Gi0/2
  ipv6 nd raguard attach-policy RA-POLICY
```

---

# **8. Infraestructura segura en Wireless**

En redes inalámbricas, se protege:

## **8.1 Gestión de APs y WLCs**

- CAPWAP en UDP 5246/5247
    
- Certificados MIC/SSC
    
- Control-plane encryption en APs remotos
    

---

## **8.2 Rogue AP Detection**

WLC identifica:

- Rogue AP
    
- Rogue Client
    
- Containment (cuando está permitido por regulación)
    

---

## **8.3 Wireless MFP / PMF**

- Management Frame Protection
    
- Requerido en WPA3
    
- Protege contra spoofing de desasociación/desautenticación
    

---

# **9. Logging, Syslog y Secure Time (NTP)**

Infraestructura segura requiere correlación temporal consistente.

Habilitar timestamps:

```
service timestamps log datetime msec
logging buffered 8192
logging host 10.10.10.10
```

NTP asegurado:

```
ntp authenticate
ntp authentication-key 1 md5 cisco123
ntp trusted-key 1
```
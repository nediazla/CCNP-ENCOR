# **Capítulo 25 – Secure Network Access Control**

Secure Access Control se enfoca en **verificar la identidad del usuario/dispositivo** y aplicar **políticas de acceso dinámicas**, evitando accesos no autorizados y segmentando la red según roles, identidades o estado del dispositivo.

Este modelo forma la base del **Zero Trust Network Access (ZTNA)**.

---

# **1. AAA – Authentication, Authorization, Accounting**

AAA es el modelo central de control de acceso.

### **1.1 Authentication**

Confirma la identidad:

- Contraseña
    
- Certificados
    
- Token-based (MFA)
    
- 802.1X (EAP)
    

### **1.2 Authorization**

Define lo que el usuario puede hacer:

- VLAN asignada
    
- ACL asignada
    
- SGT asignado (TrustSec)
    
- Políticas por rol
    

### **1.3 Accounting**

Registro de actividades:

- Hora de conexión
    
- Uso de red
    
- Eventos de comandos (TACACS+)
    

---

# **2. TACACS+ vs RADIUS**

|Protocolo|Uso|Características|
|---|---|---|
|**RADIUS**|Acceso a red (802.1X, VPN, WLAN)|Cifra solo la contraseña; usa UDP; no separa AAA|
|**TACACS+**|Administración de dispositivos|Cifra todo el payload; TCP; separa AAA; autoriza comandos|

RADIUS = acceso de usuarios  
TACACS+ = administración de equipos

---

# **3. IEEE 802.1X – el estándar de acceso seguro a la red**

### **Componentes**

- **Supplicant:** usuario/cliente
    
- **Authenticator:** switch o AP
    
- **Authentication Server:** Radius (Cisco ISE, FreeRADIUS)
    

### **Métodos EAP**

- **EAP-TLS (certificados)** → el más seguro
    
- **PEAP** → túnel TLS + MSCHAPv2
    
- **EAP-TTLS** → similar a PEAP
    
- **LEAP** → obsoleto
    

### **802.1X en switches Catalyst**

```
authentication port-control auto 
dot1x pae authenticator
```

---

# **4. MAB (MAC Authentication Bypass)**

Fallback cuando el dispositivo no soporta 802.1X.

- La MAC se envía como “credencial”
    
- Usado para impresoras, cámaras, IoT
    
- Menos seguro que 802.1X
    

---

# **5. NAC – Network Access Control**

NAC impone políticas basadas en:

- Identidad
    
- Roles
    
- Tipo de dispositivo (BYOD, corporativo, IoT)
    
- Posture (estado de salud)
    

El NAC más usado en Cisco:

- **Cisco Identity Services Engine (ISE)**
    

---

# **6. Posture Assessment (estado del dispositivo)**

El servidor NAC evalúa:

- Antivirus
    
- Actualizaciones
    
- Firewall local
    
- Integridad del SO
    
- Configuraciones corporativas
    

Si no cumple estándares:

- Se redirige a una **remediation VLAN**
    
- Se bloquea
    
- Se da acceso limitado
    

Usado en **BYOD y Zero Trust**.

---

# **7. VLAN Assignment (Dynamic VLANs)**

El servidor RADIUS puede asignar dinámicamente:

- VLAN
    
- ACL
    
- VRF
    
- SGT
    

Ejemplo de atributo RADIUS:

```
Tunnel-Type: VLAN 
Tunnel-Medium-Type: IEEE-802 
Tunnel-Private-Group-ID: 20
```

Esto permite **políticas personalizadas por usuario**.

---

# **8. Cisco TrustSec y Security Group Tags (SGTs)**

TrustSec separa seguridad de direcciones IP.  
En lugar de ACL por IP, usa **identidad**.

### **SGTs (Security Group Tags)**

Son etiquetas aplicadas a usuarios/dispositivos:

- “Employees”
    
- “Guests”
    
- “IoT”
    
- “Contractors”
    

### **SGACL (Security Group ACL)**

Define qué SGT puede hablar con cuál.

Ejemplo:

```
Employees  →  Servers: PERMIT 
Guests     →  Servers: DENY 
IoT        →  Internet only
```

### Beneficios:

- Segmentación sin depender de VLAN
    
- Escalable
    
- Más fácil de gestionar
    

---

# **9. 802.1X en Wireless**

En redes Wi-Fi:

- El AP actúa como **Authenticator**
    
- El WLC o ISE como **Authentication Server**
    

Modos:

- WPA2-Enterprise (802.1X + AES)
    
- WPA3-Enterprise (EAP-TLS obligatorio)
    

**Características:**

- Soporte PMF obligatorio en WPA3
    
- TrustSec se aplica a clientes inalámbricos igual que a cableados
    

---

# **10. Guest Access y Captive Portals**

Para invitados:

- Portal web
    
- Credenciales temporales
    
- Segmentación completa
    
- DNS redirection
    
- ACL pre-autenticación
    

Cisco ISE y WLC manejan la parte de portal y políticas.

---

# **11. Zero Trust en redes Enterprise**

Principio:  
**Nunca confiar, siempre verificar.**

Componentes clave:

1. **Identidad** (usuarios, dispositivos, aplicaciones)
    
2. **Acceso contextual** (ubicación, hora, tipo de dispositivo)
    
3. **Autorización dinámica**
    
4. **Verificación continua** (posture + telemetría)
    
5. **Microsegmentación** (SGT, VRF, VNI)
    
6. **Encrypted traffic everywhere**
    

Cisco implementa Zero Trust mediante:

- ISE (Identity)
    
- TrustSec (SGT)
    
- SD-Access (fabric + segmentación)
    
- Continuous posture assessment
    

---

# **12. Port Security (Capa 2)**

Técnica clásica pero útil como “línea base”.

Opciones:

- Sticky MAC
    
- Static MAC
    
- Maximum MACs
    

Acciones:

- shutdown
    
- restrict
    
- protect
    

Limitaciones:  
No escala bien, no es dinámico, no identifica usuarios reales.  
Complementa 802.1X, no lo reemplaza.

---

# **13. DHCP Snooping, DAI y IP Source Guard**

Técnicas de switch para evitar ataques L2:

### **DHCP Snooping**

Previene **rogue DHCP servers**.  
Switch aprende IP/MAC/puerto de clientes.

### **DAI (Dynamic ARP Inspection)**

Evita ARP spoofing usando la tabla de DHCP Snooping.

### **IP Source Guard**

Bloquea tráfico no autorizado por puerto según:

- Dirección IP
    
- MAC
    
- VLAN
    

Estas funciones son parte del **Trust Framework** en access points/switches.
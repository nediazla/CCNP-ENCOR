# **Capítulo 20 – Authenticating Wireless Clients**

---

# **1. Introducción**

Autenticar clientes inalámbricos es esencial para garantizar que:

- solo usuarios autorizados se conecten,
    
- el tráfico esté cifrado,
    
- haya trazabilidad y control,
    
- la red cumpla estándares de seguridad empresarial.
    

Los mecanismos modernos de autenticación se basan en:

- WPA2-/WPA3-Personal (PSK)
    
- WPA2-/WPA3-Enterprise (802.1X + RADIUS)
    
- Métodos EAP (PEAP, EAP-TLS, etc.)
    

En redes corporativas **la autenticación Enterprise es el estándar**.

---

# **2. WPA2 y WPA3**

## **WPA2**

Usa:

- **AES-CCMP** para cifrado
    
- 2 modos:
    
    - **Personal (PSK)**
        
    - **Enterprise (802.1X)**
        

## **WPA3**

Introduce:

- **SAE (Simultaneous Authentication of Equals)** para modo personal
    
- Eliminación total del WPA2-TKIP
    
- Mejor protección contra ataques de diccionario
    
- Mayor robustez criptográfica en enterprise (192 bits)
    

WPA3 coexistencia:

- **WPA3-Transition Mode** para dispositivos legacy
    

---

# **3. Modos de Autenticación Wi-Fi**

|Modo|Descripción|Seguridad|
|---|---|---|
|**Open**|Sin clave, sin cifrado.|Inseguro|
|**WEP**|Obsoleto, inseguro.|No usar|
|**WPA2-PSK**|Clave compartida estática.|Hogar / pequeñas redes|
|**WPA2-Enterprise**|802.1X + RADIUS|Nivel empresarial|
|**WPA3-SAE**|PSK reforzado|Alta|
|**WPA3-Enterprise**|802.1X con más seguridad|Muy alta|

---

# **4. 802.1X – El estándar de autenticación Enterprise**

802.1X define un framework de autenticación compuesto por tres roles:

### **1. Supplicant**

El cliente inalámbrico:

- laptop
    
- smartphone
    
- scanner industrial
    
- IoT compatible
    

### **2. Authenticator**

El **AP/WLC**:

- bloquea todo tráfico hasta que el cliente se autentica
    
- reenvía mensajes EAP al servidor RADIUS
    

### **3. Authentication Server**

Generalmente un servidor **RADIUS**, ej.:

- Cisco ISE
    
- Microsoft NPS
    
- FreeRADIUS
    

---

# **5. EAP (Extensible Authentication Protocol)**

EAP es un framework que define _cómo_ se autentica el usuario.

Los métodos EAP más usados son:

## **EAP-TLS**

- Usa certificados en cliente y servidor
    
- El más seguro
    
- Difícil de administrar (PKI necesaria)
    
- Recomendado en empresas con alta seguridad
    

## **PEAP (PEAP-MSCHAPv2)**

- Usa certificado solo en el servidor
    
- Usuario se valida con usuario/contraseña
    
- Fácil de administrar
    
- El más común en empresas
    

## **EAP-TTLS**

Similiar a PEAP, menos común en Cisco.

## **EAP-FAST**

- Protocolo Cisco
    
- Usa PAC (Protected Access Credential)
    
- Bueno para ambientes con dispositivos legacy
    

---

# **6. Flujo completo de autenticación 802.1X**

1. El cliente solicita conexión.
    
2. El AP/WLC responde con requerimientos 802.1X.
    
3. Inicia intercambio EAPOL (EAP over LAN).
    
4. El AP encapsula EAP en RADIUS hacia el servidor.
    
5. RADIUS valida credenciales (usuario, certificado, etc.).
    
6. Si es correcto → envía mensaje **Access-Accept**.
    
7. Se genera la clave **PMK** (Pairwise Master Key).
    
8. AP y cliente ejecutan el **4-Way Handshake**.
    
9. Cliente recibe acceso a la WLAN.
    

---

# **7. El 4-Way Handshake (WPA2/3)**

El handshake establece:

- PTK (Pairwise Transient Key)
    
- GTK (Group Temporal Key)
    
- Confirmación de integridad MIC
    
- Protección contra ataques de repetición
    

Con WPA3-SAE:

- el handshake se deriva del protocolo SAE
    

---

# **8. Autenticación en FlexConnect APs**

En sucursales remotas, FlexConnect permite dos opciones:

### **Central Authentication**

El AP reenvía EAP al WLC → RADIUS central.

### **Local Authentication (FlexConnect Local Auth)**

El AP autentica localmente si:

- el enlace WAN falla
    
- o se configura explícitamente para autonomía parcial
    

Ideal para entornos con WAN inestable.

---

# **9. VLANs dinámicas y ACLs dinámicas**

Al usar 802.1X + RADIUS, la autenticación puede devolver:

- VLAN asignada según usuario/grupo
    
- ACL específica
    
- QoS per-user
    
- Políticas de acceso (ISE Authorization Profiles)
    

Esto permite:

- separar invitados
    
- segmentar BYOD
    
- aplicar Zero Trust
    
- restringir IoT
    

---

# **10. Guest Access**

Métodos comunes:

- Captive Portal
    
- WebAuth en WLC
    
- ISE Guest Portal
    
- VLAN aislada sin acceso a red interna
    

El tráfico guest **no usa 802.1X**; se autentica por portal.

---

# **11. Mecanismos de seguridad adicionales en Wi-Fi**

|Mecanismo|Función|
|---|---|
|**Management Frame Protection (802.11w / PMF)**|Protege contra desautenticación / deasociación|
|**Rogue Detection**|Detecta APs falsos|
|**App Visibility**|Inspección de aplicaciones|
|**Client Profiling**|Clasifica tipo de dispositivo|
|**Identity PSK (iPSK)**|PSK único por usuario-dispositivo (WLC 9800)|

---

# **12. Troubleshooting de autenticación**

### **Comandos importantes (WLC 9800)**

```
show wireless client mac <mac>
show wireless profile policy all
show wireless wps session
debug wireless mac <mac>
debug aaa all
debug radius authentication
```

### **Problemas comunes**

- certificado del servidor inválido
    
- cliente no confía en CA
    
- PMF obligatorio → dispositivos antiguos fallan
    
- PSK incorrecto
    
- reloj del sistema incorrecto (NTP requerido)